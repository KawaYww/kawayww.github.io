<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æŸ³ä¸Šå·</title><meta name="description" content="æŸ³ä¸Šå·çš„åšå®¢"/><link rel="shortcut icon" href="/images/blog/avatar.avif" type="image/avif"/><link rel="stylesheet" href="/styles/highlight.min.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Regular/result.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Italic/result.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Bold/result.css"/><link rel="stylesheet" href="/styles/catppuccin-macchiato.css"/><link rel="stylesheet" href="/iconfonts/iconfont.css"/><link rel="stylesheet" href="/styles/tailwind.css"/><script src="/scripts/highlight.min.js"> </script><script src="/scripts/rust.min.js"> </script><script src="/scripts/nix.min.js"> </script><script src="/scripts/scheme.min.js"> </script><script src="/scripts/htmx.min.js"> </script><script src="/scripts/prefetch.js"> </script><script src="/scripts/custom.js"> </script><meta name="darkreader-lock"></head>
  <body>
    <div id="content" class="flex flex-col mx-4 mb-20 scroll-smooth" lang="zh-Hans">
      <div class="text-2xl sm:text-3xl my-4 w-full text-center">ã€gleam: phantom-typeã€</div>
      <div class="font-medium w-fit sm:mx-auto flex flex-col border-l-4 pl-2 sm:flex-row sm:border-l-0 sm:pl-0">
        <p>[å†™è‡ª:2024-05-20</p>
        <div class="px-2 hidden sm:inline">â”‚</div>
        <p>ä½œè€…:æŸ³ä¸Šå· ]</p>
      </div>
      <div class="flex flex-col items-center m-4">
        <div class="w-fit mx-auto text-lg font-semibold">æ‘˜è¦</div>
        <div class="w-fit break-keep text-center sm:mx-[25%] *:inline">äº†è§£ä¸‹ gleam è¯­è¨€ä¸­çš„å¹½çµç±»å‹(phantom-type)å§</div>
      </div>
      <div class="flex flex-col my-10 w-fit border-2 border-slate-500">
        <p><span class="text-2xl">ç›®å½•:</span></p>
        <div class="w-fit pr-2 my-2">
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”Œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#shen-me-shi-you-ling-lei-xing">ä»€ä¹ˆæ˜¯å¹½çµç±»å‹</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#chu-li-id">å¤„ç†ID</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#chu-li-huo-bi">å¤„ç†è´§å¸</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#yan-zheng-shu-ju">éªŒè¯æ•°æ®</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#ti-gong-shang-xia-wen">æä¾›ä¸Šä¸‹æ–‡</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â””â”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#bing-fei-ling-dan-miao-yao">å¹¶éçµä¸¹å¦™è¯</a></span></div>
        </div>
      </div>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="shen-me-shi-you-ling-lei-xing"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#shen-me-shi-you-ling-lei-xing">ä»€ä¹ˆæ˜¯å¹½çµç±»å‹</a></h1>
      <p>gleam æ˜¯é—¨ <em>ç±»å‹å®‰å…¨(type-safe)</em> çš„è¯­è¨€, <em>å¹½çµç±»å‹(phantom-type)</em> ä¾¿æ˜¯æ„æˆäº†æ­¤æ¦‚å¿µçš„éƒ¨åˆ†æŠ€å·§ä¹‹ä¸€<br><em>phantom-type(å¹½çµç±»å‹)</em>, æ˜¯æŒ‡å‡ºç°åœ¨ç±»å‹å®šä¹‰ä¸­, ä½†ä¸ä¼šç”¨ä»»ä½•æ„é€ å™¨ä¼šä½¿ç”¨åˆ°å®ƒçš„ç±»å‹å‚æ•°:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub type Xxx(phantom) {
  Xxx
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>åœ¨ <code class="font-semibold text-[#aa8bd5]"><code>Xxx</code></code> ç±»å‹ä¸­, æˆ‘ä»¬æœ‰ä¸€ä¸ªç±»å‹å‚æ•° <code class="font-semibold text-[#aa8bd5]"><code>phantom</code></code>, è¯¥å‚æ•°æœªåœ¨ä»»ä½•åœ°æ–¹è¢«ä½¿ç”¨, ä½†æ˜¯è¿™ç§å¹½çµç±»å‹å´å¯ç”¨äºæä¾›é¢å¤–çš„å®‰å…¨æ€§/ä¸Šä¸‹æ–‡<br>å¹½çµç±»å‹æ— éœ€æ”¯ä»˜ä»»ä½•è¿è¡Œæ—¶æˆæœ¬, å…¨éƒ½åœ¨ç¼–è¯‘æœŸè¢«å¤„ç†!<br><br>åœ¨æŸäº›è¯­è¨€ä¸­, å½“ç±»å‹å…·æœ‰æœªä½¿ç”¨çš„ç±»å‹å‚æ•°æ—¶, ç¼–è¯‘å™¨å¯èƒ½ä¼šå‘å‡ºè­¦å‘Š(æˆ–ç›´æ¥æ‹’ç»ç¼–è¯‘)<br>é€šå¸¸æœ‰ç‰¹å®šäºè¯­è¨€çš„è§£å†³æ–¹æ¡ˆ, ä¾‹å¦‚ rust ä¸­çš„ <code class="font-semibold text-[#aa8bd5]"><code>PhantomData</code></code> æˆ– typeScript ä¸­çš„ <code class="font-semibold text-[#aa8bd5]"><code>impossible-fields</code></code><br><br>ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨åˆ°äº†è¯¥æŠ€å·§çš„ä¾‹å­:<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="chu-li-id"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#chu-li-id">å¤„ç†ID</a></h1>
      <p>ä¸ºäº†ç†è§£å¹½çµç±»å‹çš„ç”¨å¤„, è®©æˆ‘ä»¬å…ˆä»ä¸€ä¸ªå¸¸è§åœºæ™¯å¼€å§‹, å‡è®¾æˆ‘ä»¬æ­£åœ¨æ„å»ºåƒ <a class="underline underline-offset-5 font-medium" href="https://dev.to/">dev.to</a> æˆ– <a class="underline underline-offset-5 font-medium" href="https://medium.com/">medium.com</a> è¿™æ ·çš„ç¤¾äº¤åšå®¢å¹³å°<br>æˆ‘ä»¬å¸Œæœ›æ”¯æŒä¸åŒçš„ç”¨æˆ·å’Œåšå®¢, å› æ­¤ä¸ºå®ƒä»¬åˆ†é…äº†å”¯ä¸€çš„ ID<br><br>æˆ‘ä»¬æ˜¯å®¶æ–—å¿—æ˜‚æ‰¬, å¿«é€Ÿå‘å±•çš„åˆåˆ›å…¬å¸, å› æ­¤ä»…å®æ–½äº†æœ€ç®€å•çš„ ID ç®¡ç†ç³»ç»Ÿ: åªéœ€ä¸º Int èµ·ä¸€ä¸ªç±»å‹åˆ«å, å³å¯è®©äº‹æƒ…é¡ºåˆ©è¿›è¡Œ:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">type Id = Int</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å¹³å°æ”¯æŒ reddit é£æ ¼çš„æ“ä½œå¯¹å¸–å­è¿›è¡Œ up-voting/liking(ç‚¹èµ), æˆ‘ä»¬æœ‰ä¸ªå‡½æ•° <code class="font-semibold text-[#aa8bd5]"><code>upvote</code></code>, å®ƒæ¥å—è¢«ç‚¹èµçš„å¸–å­ä¸ç‚¹èµè€…çš„ ID:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">fn upvote(user_id: Id, post_id: Id) {
  // æ“ä½œæ•°æ®åº“, æ›´æ–°è°è°è°ç‚¹èµäº†é‚£ä¸€ç¯‡å¸–å­
  // ...
  // ...
}

let user_id: Int = 114514
let post_id: Int = 1919810

upvote(user_id, post_id)</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>è¿™å¯ä»¥å·¥ä½œ, ä¸è¿‡ä»£ä»·éå¸¸è‡´å‘½, å› ä¸ºè¿™é‡Œçš„ä»£ç å¹¶ä¸å­˜åœ¨ä»»ä½•çš„ç±»å‹è¾…åŠ©, ä¹Ÿå¯ä»¥è¯´è¿™æ˜¯ä¸ªç±»å‹ä¸å®‰å…¨çš„é—®é¢˜<br>æˆ‘ä»¬éƒ½çŸ¥é“ <code class="font-semibold text-[#aa8bd5]"><code>114514</code></code> æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>user_id</code></code>, è€Œ <code class="font-semibold text-[#aa8bd5]"><code>1919810</code></code> æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>post_id</code></code>, æ‰€ä»¥è¿èµ·æ¥å°±æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>1145141919810</code></code>â€¦â€¦<br>å€˜è‹¥æœ‰ä¸€å¤©ä½ æ•²ä»£ç æ—¶, è„‘å­ä¸å°å¿ƒæ˜äº†, æŠŠä¸¤ä¸ªå‚æ•°ä¼ é€’é”™äº†ä½ç½®:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">let user_id: Int = 114514
let post_id: Int = 1919810

upvote(post_id, user_id)</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä½ è®©å¸–å­å¯¹ç”¨æˆ·è¿›è¡Œäº†ç‚¹èµ! ä½ è®© <code class="font-semibold text-[#aa8bd5]"><code>1145141919810</code></code> å˜æˆäº† <code class="font-semibold text-[#aa8bd5]"><code>1919810114514</code></code>! ä½ çœŸè¯¥æ­»å•Š!<br>è§£å†³é—®é¢˜çš„æ–¹æ³•ä¹‹ä¸€æ˜¯å®šä¹‰ä¸¤ä¸ªç‹¬ç«‹çš„ç±»å‹, è€Œä¸æ˜¯ä¾é ç±»å‹åˆ«å:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">type PostId { PostId(Int) }
type UserId { UserId(Int) }

fn upvote(user_id: UserId, post_id: PostId) {
  // ...
  // ...
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä½†è¿™ä¼šå¯¼è‡´ä½ éœ€è¦ä¸ºæ¯ä¸ªç±»å‹ç¼–å†™é‡å¤çš„ä»£ç , æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>next</code></code>, <code class="font-semibold text-[#aa8bd5]"><code>to_int</code></code>, <code class="font-semibold text-[#aa8bd5]"><code>from_string</code></code>â€¦â€¦<br>å®é™…ä¸Š, æ— è®ºæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒ, Id çš„åŸºæœ¬è¡¨ç¤ºçš„å½¢å¼éƒ½ä¿æŒä¸å˜, æˆ‘ä»¬æ›´å¸Œæœ›åœ¨ Id çš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡ŒæŒ‡å®š, ä»¥æ­¤æ£€éªŒç±»å‹çš„åˆæ³•æ€§<br>ä¾é å‰æ–‡æ‰€è¿°çš„å¹½çµç±»å‹, æˆ‘ä»¬å¯ä»¥è¿™æ ·åš:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">type Id(kind) {  // &lt;--- `kind` is a phantom type
  Id(id: Int)
}

type User
type Post

fn upvote(user_id: Id(User), post_id: Id(Post)){
  // ...
  // ...
}

pub fn example() {
  let user_id: Id(User) = Id(114514)
  let post_id: Id(Post) = Id(1919810)
  upvote(user_id, post_id)
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ç°åœ¨çš„æ“ä½œæ˜¯ç±»å‹å®‰å…¨çš„äº†, å½“ä½ äº¤æ¢ä¸¤ä¸ªå‚æ•°çš„ä½ç½®æ—¶ä¾¿ä¼šæŠ¥ <em>Type-mismatched</em> çš„é”™è¯¯<br>å¹¶ä¸”, ç°åœ¨æˆ‘ä»¬ä¸º <code class="font-semibold text-[#aa8bd5]"><code>Id</code></code> ç±»å‹å®ç°ä¸€å¤§å †é€šç”¨çš„æ–¹æ³•æ—¶, <code class="font-semibold text-[#aa8bd5]"><code>Id</code></code> ä»ç„¶æ˜¯ä¸ªè¶³å¤Ÿé€šç”¨çš„æ¦‚å¿µ:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">fn new() -> Id(kind) {
  Id(0)
}

fn next(id: Id(kind)) -> Id(kind) {
  Id(id.id + 1)
}

fn from_int(id) -> Id(kind) {
  Id(id)
}

fn show(id: Id(kind)) -> String {
  id.id |> int.to_string
}

let a: Id(Float) = 1
show(a)  // 1

let b: Id(String) = 2
show(b)  // 2

let c: Id(Bool) = 3
show(c)  // 3</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>æˆ‘ä»¬ä¸ç”¨å†å†™ <code class="font-semibold text-[#aa8bd5]"><code>UserId</code></code>/<code class="font-semibold text-[#aa8bd5]"><code>PostId</code></code>/<code class="font-semibold text-[#aa8bd5]"><code>IntId</code></code>/<code class="font-semibold text-[#aa8bd5]"><code>FloatId</code></code>/<code class="font-semibold text-[#aa8bd5]"><code>StringId</code></code>/<code class="font-semibold text-[#aa8bd5]"><code>BoolId</code></code> ç­‰ç±»å‹äº†<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="chu-li-huo-bi"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#chu-li-huo-bi">å¤„ç†è´§å¸</a></h1>
      <p>è®©æˆ‘ä»¬è€ƒè™‘å¦ä¸€ç§æƒ…å†µ:<br>æˆ‘ä»¬æƒ³è¦æ„å»ºä¸€ä¸ªåº”ç”¨, å¯ä»¥äº¤æ˜“ä¸åŒå¸ç§çš„è´§å¸(ç¾å…ƒ, äººæ°‘å¸, æ—¥å…ƒ, æ¬§å…ƒç­‰), ä¸”éœ€è¦é€šè¿‡æ±‡ç‡, åœ¨ä½¿ç”¨å®ƒä»¬å‰è½¬æ¢ä¸ºç›¸åŒå•ä½çš„è´§å¸<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">type Currency(a) {
  Currency(Float)
}

fn from_float(n: Float) -> Currency(a) {
  Currency(n)
}

type USD
type GBP

fn example() {
  let dollars: Currency(USD) = from_float(2.5)
  let pennies: Currency(GBP) = from_float(0.55)
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸€äº›è´§å¸, ä½†æ— æ³•å¯¹å®ƒä»¬åšäº›ä»€ä¹ˆ<br>è™½ç„¶æ•°å€¼å·²ç»è¢«åŒ…å«åœ¨ <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> ç±»å‹ä¸­, ä½†æˆ‘ä»¬æ— æ³•è¿›è¡Œè¿ç®—, æˆ–å°†è¢«åŒ…è£¹çš„å€¼ä¼ é€’ç»™ä»¥ <code class="font-semibold text-[#aa8bd5]"><code>Float</code></code> ä½œä¸ºå‚æ•°çš„å‡½æ•°<br><br>è®©æˆ‘ä»¬ç¼–å†™ä¸¤ä¸ªå‡½æ•°æ¥è§£å†³è¯¥é—®é¢˜: ç¼–å†™ <code class="font-semibold text-[#aa8bd5]"><code>update</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>combine</code></code> æ¥å¤„ç†è¢«åŒ…è£¹çš„å†…éƒ¨çš„ <code class="font-semibold text-[#aa8bd5]"><code>Float</code></code> å€¼<br>æˆ‘ä»¬å°†ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>update</code></code> å¤„ç†ä¸€ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code>, ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>combine</code></code> å¤„ç†ä¸¤ä¸ªç›¸åŒå¸ç§çš„ <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code><br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">fn from_float(n: Float) -> Currency(kind) {
  Currency(n)
}

fn update(a: Currency(a), f: fn (Float) -> Float) -> Currency(a) {
  let Currency(x) = a
  x |> f |> from_float
}

fn combine(a: Currency(a), b: Currency(a), f: fn (Float, Float) -> Float) -> Currency(a) {
  let Currency(x) = a
  let Currency(y) = b
  f(x, y) |> from_float
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å› ä¸º <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> çš„ç±»å‹å‚æ•°ä¸ä¼šæ”¹å˜(è¿™äº›å‡½æ•°æ¥å— <code class="font-semibold text-[#aa8bd5]"><code>Currency(a)</code></code> å¹¶è¿”å› <code class="font-semibold text-[#aa8bd5]"><code>Currency(a)</code></code>, æ‰€ä»¥å®ƒä»¬å§‹ç»ˆæ“ä½œå¹¶è¿”å›ç›¸åŒå¸ç§çš„è´§å¸<br>è¿™å°±æ˜¯å¹½çµç±»å‹åœ¨è¿™é‡Œå‘æŒ¥çš„ä½œç”¨<br><br>å¯¹äºå…¶ä»–æ•°æ®ç»“æ„, è¿™äº›å‡½æ•°å¯ä»¥å«ä½œ <code class="font-semibold text-[#aa8bd5]"><code>map</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>map2</code></code>, æ„å‘³ç€ç±»å‹å¯ä»¥æ›´æ”¹: <code class="font-semibold text-[#aa8bd5]"><code>list.map</code></code> å¯ç”¨äºå°† <code class="font-semibold text-[#aa8bd5]"><code>List(a)</code></code> è½¬æ¢ä¸º <code class="font-semibold text-[#aa8bd5]"><code>List(b)</code></code><br>å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œæ‹’ç»å°† <code class="font-semibold text-[#aa8bd5]"><code>Currency(USD)</code></code> è½¬æ¢ä¸º <code class="font-semibold text-[#aa8bd5]"><code>Currency(GBP)</code></code>, å§‹ç»ˆä¿æŒ <code class="font-semibold text-[#aa8bd5]"><code>Currency(a)</code></code>, æ‰€ä»¥è¿™äº›å‡½æ•°è¢«èµ·äº†ä¸åŒçš„åç§° :)<br><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®šä¹‰æ›´å¤šçš„å‡½æ•°, æ¯”å¦‚å°† <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> åŠ å€, æˆ–å°†ä¸¤ç§ä¸åŒå¸ç§çš„ <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> ç›¸åŠ :<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub fn double(a: Currency(a)) -> Currency(a) {
  update(a, fn (x) { x * 2 })
}

pub fn add(a: Currency(a), b: Currency(a)) -> Currency(a) {
  combine(a, b, fn (x, y) { x + y })
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä¸Šé¢çš„ä»£ç , æˆ‘ä»¬å§‹ç»ˆåªå¯¹ç›¸åŒå¸ç§(<code class="font-semibold text-[#aa8bd5]"><code>Currency(a)</code></code>) è¿›è¡Œæ“ä½œ, ä½†å¦‚æœæˆ‘ä»¬æƒ³å°†ä¸¤ç§è´§å¸åŠ åœ¨ä¸€èµ·å‘¢?<br>ä¸ºæ­¤, æˆ‘ä»¬éœ€é€šè¿‡æ±‡ç‡, å°†ä¸€ç§è´§å¸è½¬æ¢ä¸ºå¦ä¸€ç§è´§å¸, æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå†æ¬¡ä½¿ç”¨å¹½çµç±»å‹<br><code class="font-semibold text-[#aa8bd5]"><code>Exchange</code></code> ç±»å‹æè¿°äº†ä»æŸç§è´§å¸åˆ°å¦ä¸€ç§è´§å¸çš„æ±‡ç‡:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">type Exchange(from, to) {
  Exchange(Float)
}

fn exchange_rate(r: Float) -> Exchange(from, to) {
  Exchange(r)
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ç°åœ¨, å°±åƒæˆ‘ä»¬å¯¹ <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> æ‰€åšçš„é‚£æ ·, æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº› <code class="font-semibold text-[#aa8bd5]"><code>Exchange</code></code> çš„å®ä¾‹:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">let gbp_to_usd: Exchange(GBP, USD) = exchange_rate(1.41)
let usd_to_gbp: Exchange(USD, GBP) = exchange_rate(0.71)</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>æˆ‘ä»¬åˆ©ç”¨æ‰€çŸ¥é“çš„å…³äºå¹½çµç±»å‹çš„ä¿¡æ¯, å¯ä»¥å®šä¹‰ä¸€ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>convert</code></code> å‡½æ•°, å®ƒæ˜¯ç±»å‹å®‰å…¨çš„, å› ä¸ºæˆ‘ä»¬æ°¸è¿œæ— æ³•è¾“å…¥é”™è¯¯çš„æ±‡ç‡, æ‰€æœ‰å¹½çµç±»å‹éƒ½å¿…é¡»åŒ¹é…!<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub fn convert(a: Currency(from), e: Exchange(from, to)) -> Currency(to) {
  let Currency(x) = a
  let Exchange(r) = e
  x *. r |> from_float
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>æˆ‘ä»¬ç¼–å†™çš„å‡½æ•°å¯¹æ‰€æœ‰è´§å¸éƒ½æ˜¯é€šç”¨çš„, å¹¶ä¸”è¿™æ˜¯ç±»å‹å®‰å…¨çš„<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="yan-zheng-shu-ju"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#yan-zheng-shu-ju">éªŒè¯æ•°æ®</a></h1>
      <p>åˆ°ç›®å‰ä¸ºæ­¢, æˆ‘ä»¬å·²ç»çœ‹åˆ° <code class="font-semibold text-[#aa8bd5]"><code>Id</code></code>, <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> è¿™ä¸¤ä¸ªä½¿ç”¨äº†å¹½çµç±»å‹ä½œä¸ºæŠ€å·§çš„ç±»å‹, è°ƒç”¨è€…åªéœ€æä¾›ç±»å‹æ³¨é‡Šå³å¯å‘ç¼–è¯‘å™¨æ–­è¨€æŸç‰©çš„ç±»å‹<br>è¿™æ ·åšæ—¶, ç¼–è¯‘å™¨å°†åœæ­¢åœ¨é”™è¯¯çš„ä½ç½®, æ‹’ç»ä½¿ç”¨ä¸¤ä¸ªç±»å‹ä¸å®‰å…¨çš„å€¼<br><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¹½çµç±»å‹ç”¨äºç›¸åçš„ç›®çš„, ä»¥é™åˆ¶ç”¨æˆ·å¯ä»¥åˆ›å»ºçš„ç±»å‹, å¹¶é€šè¿‡æˆ‘ä»¬çš„ä»£ç è¿›è¡ŒéªŒè¯, ç„¶åæ¨åŠ¨ç”¨æˆ·åšäº›äº‹æƒ…<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub opaque type Password(kind) {
  Password(String)
}

pub type Invalid
pub type Valid

pub fn from_string(s: String) -> Password(Invalid) {
  Password(s)
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä¸å‰é¢çš„å®ä¾‹ä¸åŒ, ä¹‹å‰æ˜¯ç”±ç”¨æˆ·æ¥æŒ‡å®šæ–­è¨€ç±»å‹, æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>Id(User)</code></code>, è€Œæˆ‘ä»¬è‡ªç„¶ä¹Ÿå¯ä»¥åœ¨åº“ä¸­ä½¿ç”¨<br>åœ¨è¿™æ®µä»£ç ä¸­, <code class="font-semibold text-[#aa8bd5]"><code>Password</code></code> æ˜¯ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>opaque-type</code></code>(ä¸é€æ˜ç±»å‹), æ„å‘³ç€åªæœ‰å®šä¹‰äº†è¯¥ç±»å‹çš„æ¨¡å—(åŒæ–‡ä»¶ä¸‹), æ‰èƒ½æ„é€ ä¸æ¨¡å¼åŒ¹é…è¯¥ç±»å‹çš„å€¼<br>å› æ­¤å½“ç”¨æˆ·ä½¿ç”¨äº†è¿™ä¸ªç±»å‹æƒ³è¦åˆ›å»ºå¯†ç æ—¶, åªèƒ½é€šè¿‡ <code class="font-semibold text-[#aa8bd5]"><code>from_string</code></code> å‡½æ•°<br><br>ç”±ç”¨æˆ·ä¼ å…¥çš„å­—ç¬¦ä¸²æ‰€åˆ›å»ºçš„å¯†ç , é»˜è®¤æœªç»éªŒè¯, æ‰€ä»¥åœ¨ç±»å‹ä¸Šæ˜¯éæ³•(Invalid)çš„, ç”¨æˆ·éœ€é€šè¿‡æˆ‘ä»¬æä¾›çš„éªŒè¯æ‰‹æ®µæ¥è·å¾—åˆæ³•å¯†ç <br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub type InvalidReason{
  TooLong
  TooShort
  NoNumber
  NoLetter
  // ...
  // ...
}

pub fn validate(password: Password(Invalid)) -> Result(Password(Valid), InvalidReason) {
  // ...
}

pub fn suggest(passwor: Password(Invalid)) -> String {
  // ...
}

pub fn create_user(username: String, password: Password(Valid)) -> User {
  // ...
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä¸Šé¢å†æ¬¡å‘ˆç°äº†ä¸€æ®µç±»å‹å®‰å…¨çš„ä»£ç , å› ä¸º <code class="font-semibold text-[#aa8bd5]"><code>Password</code></code> æ˜¯ opaque çš„, æ‰€ä»¥ç”¨æˆ·å¿…é¡»é€šè¿‡ <code class="font-semibold text-[#aa8bd5]"><code>validate</code></code> æ¥è·å–åˆæ³•çš„å¯†ç <br><code class="font-semibold text-[#aa8bd5]"><code>suggest</code></code> å‡½æ•°ä¸ºéæ³•å¯†ç ç»™å‡ºäº†ä¸€äº›å»ºè®®, <code class="font-semibold text-[#aa8bd5]"><code>create_user</code></code> åªæ¥æ”¶åˆæ³•å¯†ç å¹¶åˆ›å»ºç”¨æˆ·<br><br>å› ä¸ºåªæœ‰ <code class="font-semibold text-[#aa8bd5]"><code>validate</code></code> æ£€éªŒæˆåŠŸ, æ‰èƒ½è·å¾— <code class="font-semibold text-[#aa8bd5]"><code>Password(Valid)</code></code><br>æ‰€ä»¥åœ¨å…¶ä»–ä½¿ç”¨äº† <code class="font-semibold text-[#aa8bd5]"><code>Password(Valid)</code></code> çš„åœ°æ–¹, æ¥æ”¶çš„å¯†ç ä¸€å®šæ˜¯åˆæ³•çš„<br>å¯¹æ¯”ä»¥ä¸‹è¿™æ®µä»£ç :<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub type Password {
  // ...
}

pub fn is_valid(Pasword) -> Bool {
  // ...
}

pub fn create_user(username: String, password: Password) -> User {
  // ...
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>æ˜¾è€Œæ˜“è§, è¿™æ®µä»£ç ä¸æ˜¯ç±»å‹å®‰å…¨çš„: ä½ å¦‚ä½•ç¡®ä¿ç”¨æˆ·å°±ä¸€å®šä¼šä¹–ä¹–è°ƒç”¨ <code class="font-semibold text-[#aa8bd5]"><code>is_valid</code></code>, è€Œä¸æ˜¯ç›´æ¥ä¼ å…¥éæ³•çš„ä»£ç å‘¢?<br>å› æ­¤åªå¥½ç”±åº“ä½œè€…å¤šåšä¸€äº›å·¥ä½œ, ç”±æˆ‘ä»¬æ¥ä¸ºç”¨æˆ·è°ƒç”¨ <code class="font-semibold text-[#aa8bd5]"><code>is_valid</code></code>, ç„¶åè®¾è®¡ä¸€äº›å…¶ä»–çš„ api ç¡®ä¿å·¥ä½œé¡ºåˆ©â€¦â€¦<br>ç›¸æ¯”ä¹‹ä¸‹, å‰ä¸€æ®µä»£ç ç›´æ¥å°†è¿™äº›æš´éœ²å‡ºæ¥äº¤ç»™äº†ç”¨æˆ·: ä½ çˆ±è°ƒä¸è°ƒ, åæ­£ä½ ä¸è°ƒç”¨ <code class="font-semibold text-[#aa8bd5]"><code>validate</code></code> å‡½æ•°å°±æ°¸è¿œå¾—ä¸åˆ°ç±»å‹ä¸Šåˆæ³•çš„å¯†ç <br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="ti-gong-shang-xia-wen"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#ti-gong-shang-xia-wen">æä¾›ä¸Šä¸‹æ–‡</a></h1>
      <p>åœ¨ gleam ä¸­, å¯èƒ½å¼•å‘é”™è¯¯çš„å‡½æ•°é€šå¸¸ä½¿ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>Result</code></code> ç±»å‹ä¸ç‰¹å®šçš„ <code class="font-semibold text-[#aa8bd5]"><code>Error</code></code> ç±»å‹è¿›è¡ŒåŒ…è£…, åè€…æè¿°äº†æ‰€æœ‰å¤±è´¥çš„å¯èƒ½åŸå› <br>å½“ä¸¤ä¸ªå‡½æ•°(å‡è®¾æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>accept</code></code> å’Œ <code class="font-semibold text-[#aa8bd5]"><code>listen</code></code>)å¯èƒ½å¼•å‘ä¸åŒé”™è¯¯æ—¶, æˆ‘ä»¬æƒ³ä¸ºè¿™ä¸¤ä¸ªå‡½æ•°åˆ›å»ºå¯¹åº”çš„ <code class="font-semibold text-[#aa8bd5]"><code>Error</code></code> ç±»å‹<br><br>ä½†ä¸¤ä¸ªå‡½æ•°ä¹‹é—´å…±äº«éƒ¨åˆ†é”™è¯¯æ—¶, å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜, å‡è®¾å­˜åœ¨ä»¥ä¸‹ä»£ç :<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub type AcceptError = {
  SystemLimit       // &lt;-- Here
  Closed
  Timeout
  Posix(inet.Posix) // &lt;-- Here
}

pub type ListenError = {
  SystemLimit        // &lt;-- Here
  Posix(inet.Posix)  // &lt;-- Here
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>åŒä¸€æ¨¡å—ä¸­çš„ä¸åŒç±»å‹, ä¸å¯èƒ½å…·æœ‰ç›¸åŒåç§°çš„å˜ä½“, å¦åˆ™ç¼–è¯‘å™¨æ€ä¹ˆçŸ¥é“ <code class="font-semibold text-[#aa8bd5]"><code>SystemLimit</code></code> åˆ°åº•æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>AcceptError</code></code> è¿˜æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>ListenError</code></code><br>(â€¦å—¯, è¿™é‡Œå…¶ä»–è¯­è¨€çš„è¯»è€…å¯èƒ½ä¼šè§‰å¾—æœ‰äº›åç›´è§‰, å»ºè®®ä¹ æƒ¯é€‚åº”ä¸€ä¸‹)<br><br>æˆ‘ä»¬å½“ç„¶å¯ä»¥ç»™æ¯ä¸ªå˜ä½“æ·»åŠ ç‰¹å®šçš„å‰ç¼€, æˆ–ä¸ºå®ƒä»¬åˆ›å»ºå•ç‹¬çš„æ¨¡å—<br>æˆ‘ä»¬äº¦å¯ä»¥æ”¾å¼ƒç‰¹å®šäºå‡½æ•°çš„ <code class="font-semibold text-[#aa8bd5]"><code>Error</code></code> ç±»å‹è€Œåˆ›å»ºæ•´ä¸ªæ¨¡å—ä¸‹çš„å•ä¸€ <code class="font-semibold text-[#aa8bd5]"><code>Error</code></code> ç±»å‹<br><br>è¿™äº›è§£å†³æ–¹æ¡ˆè¦ä¹ˆçœ‹èµ·æ¥å¤ªç¹ç, è¦ä¹ˆå½“éœ€è¦å…±äº«ç±»å‹æ—¶å˜å¾—å¤æ‚, è¦ä¹ˆå¤±å»äº†è¡¨è¾¾ç‰¹å®šäºæŸä¸ªå‡½æ•°çš„é”™è¯¯ç±»å‹çš„èƒ½åŠ›<br>ä½†å¦‚æœæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¹½çµç±»å‹, å°±å¯ä»¥å¯ç”¨ä¸€ä¸ªæ–°çš„é€‰é¡¹:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub type Error(from) {
  SystemLimit
  Closed
  Timeout
  Posix(inet.Posix)
}

pub opaque type AcceptFn { AcceptFn }
pub opaque type ListenFn { ListenFn }

pub fn accept() -> Error(AcceptFn) {
  // ...
}

pub fn listen() -> Error(ListenFn) {
  // ...
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>è™½ç„¶è¿™ç§æ–¹æ³•æ— æ³•å¸¦æ¥é¢å¤–çš„å®‰å…¨æ€§, ä½†å®ƒç¡®å®ä¸ºä½¿ç”¨æ­¤åŠŸèƒ½çš„å¼€å‘äººå‘˜æä¾›äº†ä¸Šä¸‹æ–‡çº¿ç´¢<br>åœ¨å¤„ç†ä¸æŠ›å‡º <code class="font-semibold text-[#aa8bd5]"><code>listen</code></code> çš„é”™è¯¯æ—¶, ä»–ä»¬çŸ¥é“ä»–ä»¬å¯ä»¥å®‰å…¨åœ°å¿½ç•¥ <code class="font-semibold text-[#aa8bd5]"><code>Closed</code></code> å’Œ <code class="font-semibold text-[#aa8bd5]"><code>Timeout</code></code> é”™è¯¯, åªå…³æ³¨ç›¸å…³çš„é”™è¯¯<br><br>é€šè¿‡å¹½çµç±»å‹æ¥æä¾›ä¸Šä¸‹æ–‡çº¿ç´¢, è¿™å¯èƒ½å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„è®¾è®¡å†³ç­–, ä½†å®ƒç¡®å®åœ¨æŸäº›æƒ…å†µä¸‹åœ¨ç®€å•æ€§å’Œè¡¨ç°åŠ›ä¹‹é—´å–å¾—äº†é€‚å½“çš„å¹³è¡¡<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="bing-fei-ling-dan-miao-yao"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#bing-fei-ling-dan-miao-yao">å¹¶éçµä¸¹å¦™è¯</a></h1>
      <p>ä½ å¯èƒ½æ¸´æœ›å°†å¹½çµç±»å‹åº”ç”¨äºæ‰€æœ‰ä»£ç , å¹¶åˆ©ç”¨é¢å¤–çš„ç¼–è¯‘æ—¶å®‰å…¨æ€§, ä½†åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒæœ‰ä¸€ä¸ªæ³¨æ„ç‚¹:<br>æˆ‘ä»¬ä¸èƒ½åŸºäºå¹½çµç±»å‹å¯¹å‡½æ•°çš„è¡Œä¸ºè¿›è¡Œåˆ†æ”¯<br><br>ä¸ºäº†ä¸¾ä¾‹è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè¯·è€ƒè™‘ <code class="font-semibold text-[#aa8bd5]"><code>Currency</code></code> ç±»å‹çš„ <code class="font-semibold text-[#aa8bd5]"><code>to_string</code></code> å‡½æ•°çš„ä¸å¯èƒ½å®ç°:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub fn to_string (a: Currency(a)) -> String {
  let Currency(val) = a
  case a.phantom_type {
    USD -> string.concat("$", float.to_string(val))
    GBP -> string.concat("Â£", float.to_string(val))
    // ...
    // ...
  }
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>è¿™æ˜¯ä¸å¯èƒ½çš„, å› ä¸º <code class="font-semibold text-[#aa8bd5]"><code>to_string</code></code> å‡½æ•°å¿…é¡»ä¿è¯å¯¹æ‰€æœ‰ <code class="font-semibold text-[#aa8bd5]"><code>Currency(a)</code></code> éƒ½æ˜¯é€šç”¨çš„, æˆ‘ä»¬æ— æ³•æ ¹æ® <code class="font-semibold text-[#aa8bd5]"><code>a</code></code> çš„å®é™…ç±»å‹æ¥æ”¹å˜è¡Œä¸º<br></p>
      <hr class="border-2 border-dashed my-10">
      <div class="flex flex-col sm:mx-2 *:my-2"><a class="flex items-center border-2 border-slate-500 w-full sm:rounded-md hover:border-white  justify-start " href="/posts/gleam/use-expression" hx-get="/posts/gleam/use-expression/index.html" hx-target="body" hx-push-url="/posts/gleam/use-expression" hx-swap="innerHTML show:window:top"><span class="text-2xl sm:text-4xl sm:p-2 pl-2 pr-1 order-first ">&lt;</span> <span class="text-xl sm:text-2xl sm:p-2">gleam: use-expression</span></a></div>
    </div>
  </body>
</html>
