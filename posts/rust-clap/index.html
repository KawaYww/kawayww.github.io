<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æŸ³ä¸Šå·</title><meta name="description" content="æŸ³ä¸Šå·çš„åšå®¢"/><link rel="shortcut icon" href="/images/blog/avatar.avif" type="image/avif"/><link rel="stylesheet" href="/styles/highlight.min.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Regular/result.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Italic/result.css"/><link rel="stylesheet" href="/fonts/MapleMono-NF-CN-Bold/result.css"/><link rel="stylesheet" href="/styles/catppuccin-macchiato.css"/><link rel="stylesheet" href="/iconfonts/iconfont.css"/><link rel="stylesheet" href="/styles/tailwind.css"/><script src="/scripts/highlight.min.js"> </script><script src="/scripts/rust.min.js"> </script><script src="/scripts/nix.min.js"> </script><script src="/scripts/scheme.min.js"> </script><script src="/scripts/htmx.min.js"> </script><script src="/scripts/prefetch.js"> </script><script src="/scripts/custom.js"> </script><meta name="darkreader-lock"></head>
  <body>
    <div id="content" class="flex flex-col mx-4 mb-20 scroll-smooth" lang="zh-Hans">
      <div class="text-2xl sm:text-3xl my-4 w-full text-center">ã€clap-rs ç®€ä»‹ã€</div>
      <div class="font-medium w-fit sm:mx-auto flex flex-col border-l-4 pl-2 sm:flex-row sm:border-l-0 sm:pl-0">
        <p>[å†™è‡ª:2022-08-16</p>
        <div class="px-2 hidden sm:inline">â”‚</div>
        <p>ä½œè€…:æŸ³ä¸Šå· ]</p>
      </div>
      <div class="flex flex-col items-center m-4">
        <div class="w-fit mx-auto text-lg font-semibold">æ‘˜è¦</div>
        <div class="w-fit break-keep text-center sm:mx-[25%] *:inline">äº†è§£å‘½ä»¤è¡Œ, ç„¶åç”¨ clap-rs å†™ä¸ªç±»ä¼¼ GNU/wc çš„å°å‘½ä»¤å§, å¢åŠ äº†è¿›åº¦æ¡, è¡¨æ ¼è¾“å‡º, å¹¶è¡ŒåŒ–ç­‰åŠŸèƒ½</div>
      </div>
      <div class="flex flex-col my-10 w-fit border-2 border-slate-500">
        <p><span class="text-2xl">ç›®å½•:</span></p>
        <div class="w-fit pr-2 my-2">
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”Œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#cheng-pin-zhan-shi">æˆå“å±•ç¤º</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#ji-chu-gai-nian">åŸºç¡€æ¦‚å¿µ</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#chu-shi-pei-zhi">åˆå§‹é…ç½®</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#ming-ling-ding-yi">å‘½ä»¤å®šä¹‰</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â”€â”€</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#bang-zhu-xin-xi">å¸®åŠ©ä¿¡æ¯</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â”€â”€</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#xuan-xiang-yu-can-shu">é€‰é¡¹ä¸å‚æ•°</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â”€â”€</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#can-shu-jie-xi-qi">å‚æ•°è§£æå™¨</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â”€â”€</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#can-shu-guan-xi">å‚æ•°å…³ç³»</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â”€â”€</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#zi-ming-ling">å­å‘½ä»¤</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â”œâ”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#luo-ji-shi-xian">é€»è¾‘å®ç°</a></span></div>
          <div class="leading-5"><span class="pl-2"><span class="font-bold text-sm">â””â”€â–º</span><a class="text-sm hover:text-sky-500 hover:font-semibold hover:underline underline-offset-5" href="#zi-dong-bu-quan">è‡ªåŠ¨è¡¥å…¨</a></span></div>
        </div>
      </div>
      <p>å‰ç½®çŸ¥è¯†: rust è¯­æ³•åŸºç¡€<br>å®Œæ•´ä»£ç : <a class="underline underline-offset-5 font-medium" href="https://github.com/Jedsek/rust-wc">rust-wc</a><br><br><em>æ³¨æ„</em>:<br>æœ¬é¡¹ç›®åŸºäºå½“å‰æœ€æ–°ç‰ˆæœ¬çš„ clap, ä¹Ÿå°±æ˜¯ version 4 æœ¬é¡¹ç›®ä½¿ç”¨ clap ä¸­çš„ derive ç‰¹æ€§, è€Œé builder ç‰¹æ€§ (å…¶å®å·®ä¸å¤š)<br>æ¨èè¯»è€…åˆ«ç›´æ¥è·Ÿç€æ•²ä»£ç , å…ˆæ•´ä½“çœ‹ä¸€é, æ˜ç™½å¤§è‡´æ€è·¯åå†åŠ¨æ‰‹<br><br>å®˜æ–¹æ•™ç¨‹: <a class="underline underline-offset-5 font-medium" href="https://docs.rs/clap/latest/clap/_derive/_tutorial/index.html">derive-tutorial</a><br>å®˜æ–¹èµ„æ–™: <a class="underline underline-offset-5 font-medium" href="https://docs.rs/clap/latest/clap/_derive/index.html">derive-reference</a><br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="cheng-pin-zhan-shi"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#cheng-pin-zhan-shi">æˆå“å±•ç¤º</a></h1>
      <ul class="list-disc ml-5">
        <li>é€šè¿‡å¦‚ä¸‹å‘½ä»¤ä» crates.io ä¸Šä¸‹è½½æˆå“, å¯æ‰§è¡Œæ–‡ä»¶çš„åç§°æ˜¯ rwc:</li>
      </ul>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">cargo install rust-wc</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ asciinema å½•åˆ¶çš„å±•ç¤º:<br></p>
      <script id="asciicast-534647" src="https://asciinema.org/a/534647.js">
      </script>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="ji-chu-gai-nian"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#ji-chu-gai-nian">åŸºç¡€æ¦‚å¿µ</a></h1>
      <p>CLI, æ˜¯ <em>Command Line Interface</em> çš„ç®€ç§°, æ„æ€æ˜¯å‘½ä»¤è¡Œç•Œé¢, å’Œ GUI/TUI æ˜¯ä¸€ä¸ªé“ç†<br>å¦‚åœ¨Linuxä¸‹å¸¸è§çš„ ls/cp/mv ç­‰å‘½ä»¤, ä½ ä¼ å…¥å‚æ•°, å®ƒå°±ä¼šåšäº›äº‹æƒ…, å¹¶å¯èƒ½ä¼šæ‰“å°ç›¸åº”è¾“å‡º<br><br>GNU é¡¹ç›®æä¾›äº†éå¸¸å¤šçš„å¼€æºå‘½ä»¤, å¦‚ wc, å®ƒå¯ä»¥ç»Ÿè®¡æ–‡ä»¶çš„ bytes/char/line çš„æ•°é‡<br>æˆ‘ä»¬å°†ä¼šä½¿ç”¨ Rust è¯­è¨€, æ­é…ä¸€ä¸ªå« clap çš„åº“, å†™ä¸€ä¸ªå‡çº§ç‰ˆçš„ wc<br><br><em>æ³¨æ„</em>:<br>cli å¯ä»¥ä»£è¡¨æŠ½è±¡çš„ç•Œé¢, ä¹Ÿå¯ä»¥æŒ‡ä»£å…·ä½“çš„æŸä¸ªç¨‹åº<br>åæ–‡ä¸­çš„ cli , ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æŒ‡ä»£æŸä¸ªå…·ä½“çš„å‘½ä»¤è¡Œç¨‹åº, æ¯”å¦‚ ls/cp ç­‰<br><br>å†å†™ä¹‹å‰, æˆ‘ä»¬è¿˜åº”äº†è§£äº›åŸºæœ¬æ¦‚å¿µ (ç›´æ¥è·³è¿‡æ„Ÿè§‰ä¹Ÿæœ¨å¾—é—®é¢˜??):<br><br></p>
      <ul class="list-disc ml-5">
        <li>å‚æ•°(arguments):<br></li>
      </ul>
      <p>ä¼ ç»™å‘½ä»¤çš„å‚æ•°, æ¯”å¦‚ä¸€ä¸ªè·¯å¾„<br><br></p>
      <ul class="list-disc ml-5">
        <li>é€‰é¡¹(options):<br></li>
      </ul>
      <p>é€šå¸¸ä»¥å•/åŒæ¨ªæ å¼€å¤´, ä¸åŒçš„ options è¡¨ç¤ºä¸åŒçš„è¡Œä¸º<br>æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>ls ./*</code></code>, è¡¨ç¤ºä»¥é»˜è®¤è¡Œä¸ºä¸‹è¿›è¡Œè¾“å‡º, <code class="font-semibold text-[#aa8bd5]"><code>ls -l ./*</code></code> ä»¥é•¿åˆ—è¡¨å½¢å¼è¾“å‡º, <code class="font-semibold text-[#aa8bd5]"><code>ls -a ./*</code></code> è¾“å‡ºæ‰€æœ‰éšè—æ–‡ä»¶<br>å•æ¨ªæ å¼€å¤´çš„åªæœ‰ä¸€ä¸ªå­—æ¯, åŒæ¨ªæ å¼€å¤´çš„å¯ä»¥æœ‰å¾ˆå¤šå­—æ¯, å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>ls -i</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>ls --inode</code></code><br><br></p>
      <ul class="list-disc ml-5">
        <li>å­å‘½ä»¤(subcommands):<br></li>
      </ul>
      <p>ä¸€ä¸ªå‘½ä»¤çš„å­å‘½ä»¤, é€šå¸¸æƒ…å†µä¸‹éœ€è¦ä¸åŒçš„ args, æœ‰ä¸åŒçš„ options<br>æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>cargo build</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>cargo publish</code></code>, éƒ½æ˜¯ cargo çš„å­å‘½ä»¤<br><br></p>
      <ul class="list-disc ml-5">
        <li>åŒæ¨ªæ (â€“):<br></li>
      </ul>
      <p>åœ¨å‘½ä»¤åé¢çš„æŸå¤„ä½ç½®, åŠ ä¸Š <code class="font-semibold text-[#aa8bd5]"><code>--</code></code>, å¯ä»¥å°† <code class="font-semibold text-[#aa8bd5]"><code>--</code></code> åé¢çš„å†…å®¹å½“ä½œ argument ä¼ å…¥, è€Œé options<br>ä¸¾ä¸ªä¾‹å­, æˆ‘æœ‰ä¸ªæ–‡ä»¶, å«åš <code class="font-semibold text-[#aa8bd5]"><code>--asd</code></code>, æˆ‘æƒ³ä½¿ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>cat --asd</code></code> æ¥è¾“å‡ºé‡Œé¢çš„å†…å®¹<br>å¦‚æœä½ ç›´æ¥è¿™æ ·ä¼ å‚, å› ä¸ºæ–‡ä»¶åä»¥æ¨ªæ å¼€å¤´, å°†ä¼šè¢«å‘½ä»¤è§†ä½œ options, è€Œ <code class="font-semibold text-[#aa8bd5]"><code>cat</code></code> æœ¬èº«æ²¡ <code class="font-semibold text-[#aa8bd5]"><code>--asd</code></code> è¿™ä¸ªoption, æ•…å¤±è´¥<br>åœ¨æ¯”å¦‚æœ‰ä¸ªæ–‡ä»¶å« <code class="font-semibold text-[#aa8bd5]"><code>--help</code></code>, ä½¿ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>cat --help</code></code> å°†ä¼šæ‰“å°å…¶ help ä¿¡æ¯<br>æ­¤æ—¶, ä½ åº”è¯¥ä½¿ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>cat -- --asd</code></code>, å°† <code class="font-semibold text-[#aa8bd5]"><code>--asd</code></code> è§†ä½œå‚æ•°ä¼ å…¥<br><br></p>
      <ul class="list-disc ml-5">
        <li>çŸ­/é•¿å¸®åŠ©(short/long help):<br></li>
      </ul>
      <p>æœ‰äº›å‘½ä»¤, <code class="font-semibold text-[#aa8bd5]"><code>-h</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>--help</code></code> åˆ†åˆ«å¯¹åº”çŸ­å¸®åŠ©ä¸é•¿å¸®åŠ©, åè€…æ¯”å‰è€…ä¼šæ˜¾ç¤ºæ›´å¤šæç¤ºä¿¡æ¯<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="chu-shi-pei-zhi"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#chu-shi-pei-zhi">åˆå§‹é…ç½®</a></h1>
      <p>ä»¥ä¸‹æ˜¯å±‚æ¬¡ç»“æ„, ä¹‹åè¦ç”Ÿæˆè‡ªåŠ¨è¡¥å…¨æ–‡ä»¶æ—¶, è¿˜ä¼šå†å¢åŠ ä¸€äº›æ–‡ä»¶, è¯·è‡ªè¡Œåˆ›å»ºå¥½ç›®å½•:</p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">./rust-wc
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src
   â”œâ”€â”€ wc_result.rs   # è®¡ç®—å¹¶å­˜å‚¨ç»“æœ
   â”œâ”€â”€ cli.rs         # å‘½ä»¤è¡Œçš„å®šä¹‰
   â”œâ”€â”€ files.rs       # è¯»å–æ–‡ä»¶
   â”œâ”€â”€ lib.rs         # å£°æ˜æ¨¡å—, ç±»å‹åˆ«å
   â””â”€â”€ main.rs</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>è®©æˆ‘ä»¬æ–°å»ºä¸€ä¸ªå«åš rust-wc çš„é¡¹ç›®:</p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-toml text-sm sm:text-base"># Cargo.toml
# åŒ…åä¸º `rust-wc` (å› ä¸ºæˆ‘å‘å¸ƒåˆ° crates.io çš„æ—¶å€™, `rwc` å·²ç»è¢«å äº†å‘œå‘œå‘œå‘œå‘œ)
[package]
name = "rust-wc"
authors = ["jedsek &lt;jedsek@qq.com>"]
version = "0.0.1"
description = "A GNU/wc implementation written in rust, which is faster when reading a large of big files"
edition = "2021"

# æŒ‡å®šç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„åå­—, æ­¤å¤„æ˜¯ `rwc`, è™½ç„¶åŒ…åæ˜¯ `rust-wc`, ä½†å‘½ä»¤æ˜¯ `rwc`
[[bin]]
name = "rwc"
path = "src/main.rs"

# æŒ‡å®šä¾èµ–
[dependencies]
clap = {version = "4.0.29", features = ["derive"]}     # è§£æå‚æ•°
unicode-width = "0.1.10"                               # è®¡ç®— Unicode å­—ç¬¦å®½åº¦
indicatif = "0.17.2"                                   # è¿›åº¦æ¡
prettytable-rs = "0.9.0"                               # æ‰“å°è¡¨æ ¼
rayon = "1.6.1"                                        # å¹¶è¡ŒåŒ–</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/lib.rs
use std::{collections::HashMap, path::PathBuf};

pub mod cli;
pub mod files;
pub mod wc_result;

pub type Result&lt;T> = std::result::Result&lt;T, Box&lt;dyn std::error::Error>>;
pub type Counts = Vec&lt;usize>;
pub type PathWithContent = HashMap&lt;PathBuf, String>;</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="ming-ling-ding-yi"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#ming-ling-ding-yi">å‘½ä»¤å®šä¹‰</a></h1>
      <p><em>æ³¨æ„</em>:<br>clap-v3 æ—¶, èè¿›äº†å¦ä¸€ä¸ªå¾ˆå¼ºå¤§çš„å‘½ä»¤è¡Œç¼–å†™åº“: structopt<br>å› æ­¤ä»¥åçœ‹è§ structopt ä¸ clap, ç›´æ¥ç”¨ clap å°±å®Œäº‹äº†, å‰è€…ä¹Ÿå‘è¿‡é€šçŸ¥, è®©åˆ«äººç›´æ¥ç”¨ clap<br>è¿™ç»™ clap å¸¦æ¥çš„å·¨å¤§å˜åŒ–, å°±æ˜¯å‡ºç°äº†deriveå®, ä»¥ä¸€ç§éå¸¸ä¾¿åˆ©çš„å£°æ˜å¼å†™æ³•, å¸®ä½ ç”Ÿæˆä¸è§£æä»£ç <br><br>è®©æˆ‘ä»¬æ¥æƒ³è±¡ä¸‹è¿™ä¸ªå‘½ä»¤:<br></p>
      <ul class="list-disc ml-5">
        <li>å¿…é¡»æ¥å—ä¸€ä¸ªå‚æ•°</li>
        <li>å‚æ•°å¿…é¡»æ˜¯å­˜åœ¨çš„è·¯å¾„, æˆ–è€…æ˜¯ -, è¡¨ç¤ºä»æ ‡å‡†è¾“å…¥è¯»å–å†…å®¹</li>
        <li>æ ¹æ®å¯ç”¨çš„ flag æ¥å†³å®šè®¡ç®—å¹¶æ‰“å°å“ªäº›ä¸œè¥¿</li>
      </ul>
      <p><br>å¤šäºäº† derive å®, æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰å®ƒ, ä¸‹é¢æ˜¯ <code class="font-semibold text-[#aa8bd5]"><code>src/cli.rs</code></code> çš„å®Œæ•´ä»£ç :<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/cli.rs
use clap::{ArgGroup, Parser, Subcommand};
use std::path::PathBuf;

#[derive(Parser)]  // è¿™é‡Œçš„ derive(Parser) è¡¨ç¤ºä¸‹é¢è¿™ä¸€å¨éƒ½ä¼šè¢« `å®çš„é»‘é­”æ³•` æ‰€æ´—ç¤¼ 
#[command(
    author, version, about, subcommand_negates_reqs = true,
    group(
        ArgGroup::new("options")
            .multiple(true)
            .required(true)
            .args(&amp;[ "bytes", "chars", "words", "lines", "longest_line"])
    ),
)]
pub struct Cli {
    /// The path(s) you should provide
    #[arg(value_parser = check_path, value_name = "PATH", required = true)]
    pub paths: Vec&lt;PathBuf>,

    /// Print the byte counts
    #[arg(short, long)]
    pub bytes: bool,

    /// Print the character counts
    #[arg(short, long)]
    pub chars: bool,

    /// Print the word counts
    #[arg(short, long)]
    pub words: bool,

    /// Print the line counts
    #[arg(short, long)]
    pub lines: bool,

    /// Print the maximum line width (Unicode)
    #[arg(short = 'L', long)]
    pub longest_line: bool,

    #[command(subcommand)]
    pub sub_commands: Option&lt;SubCommands>,
}

#[derive(Subcommand)]
pub enum SubCommands {
    /// Enabled all available options
    All {
        /// The path(s) you should provide
        #[arg(value_parser = check_path, value_name = "PATH", required = true)]
        paths: Vec&lt;PathBuf>,
    },
}


// è‡ªå®šä¹‰äº†ä¸€ä¸ªè§£æå™¨, æ£€æµ‹è·¯å¾„æ˜¯å¦å­˜åœ¨, æˆ–è€…æ˜¯å¦ä»æ ‡å‡†è¾“å…¥è¯»å–å†…å®¹
fn check_path(filename: &amp;str) -> Result&lt;PathBuf, String> {
    let path = PathBuf::from(filename);
    if filename == "-" || path.exists() {
        Ok(path)
    } else {
        Err(format!("No such path: `{}`", path.display()))
    }
}

impl Cli {
    // å¼€å¯æ‰€æœ‰çš„ options
    pub fn enable_all_options(&amp;mut self) {
        self.bytes = true;
        self.chars = true;
        self.words = true;
        self.lines = true;
        self.longest_line = true;
    }
        
    // è¿”å›å¯ç”¨çš„options, ç±»å‹æ˜¯ Vec&lt;&amp;str>, æ–¹ä¾¿åé¢æ‰“å°è¡¨æ ¼æ—¶, ä½œä¸ºè¡¨æ ¼çš„æ ‡é¢˜
    pub fn get_enabled_options(&amp;self) -> Vec&lt;&amp;'static str> {
        let mut enabled_options = vec![];

        self.bytes.then(|| enabled_options.push("Bytes"));
        self.chars.then(|| enabled_options.push("Chars"));
        self.words.then(|| enabled_options.push("Words"));
        self.lines.then(|| enabled_options.push("Lines"));
        self.longest_line.then(|| enabled_options.push("Maximum line width (Unicode)"));

        enabled_options
    }
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä»¥ä¸Šçš„ä»£ç è¡¨ç¤º, æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>Cli</code></code> ç»“æ„ä½“, è¡¨ç¤ºå¯¹è¾“å…¥å‚æ•°çš„å»ºæ¨¡<br>å¾—ç›Šäºå®çš„é»‘é­”æ³•, clap å°†ç”Ÿæˆä¸€äº›ä»£ç , ä½¿æˆ‘ä»¬ä¸ç”¨å†è€—è´¹è„‘åŠ›, è€ƒè™‘å¦‚ä½•å¤„ç†è¾“å…¥å‚æ•°, å¹¶å°†å…¶è§£æä¸ºå¯¹åº”ç±»å‹<br>ä¹Ÿä¸ç”¨å†è€ƒè™‘è§£æå¤±è´¥æ—¶, åº”è¯¥å¦‚ä½•ç¼–å†™ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º<br><br>clap å·²ç»ä¸ºæˆ‘ä»¬åšå¥½äº†ä¸€åˆ‡ :)<br>æˆ‘ä»¬èƒ½è°ƒç”¨ clap ä¸ºæˆ‘ä»¬å®ç°çš„ trait <code class="font-semibold text-[#aa8bd5]"><code>Parser</code></code> ä¸­çš„ <code class="font-semibold text-[#aa8bd5]"><code>parse</code></code> æ–¹æ³•, è§£æå‚æ•°å¹¶è¿›è¡Œè½¬æ¢:<br></p>
      <h2 class="flex items-center w-fit my-6" id="bang-zhu-xin-xi"><span class="text-2xl m-2 text-cyan-500">></span> <a class="text-2xl hover:underline underline-offset-8" href="#bang-zhu-xin-xi">å¸®åŠ©ä¿¡æ¯</a></h2>
      <p>ç°åœ¨å…ˆè®©æˆ‘ä»¬è¿è¡Œ <code class="font-semibold text-[#aa8bd5]"><code>cargo run -- -h</code></code> çœ‹çœ‹æ•ˆæœ, æŸ¥çœ‹ä¸‹ help å§:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">A GNU/wc clone written in rust, which is super faster when reading a large of big files

Usage: rwc &lt;--bytes|--chars|--words|--lines|--longest-line> &lt;PATH>...
       rwc [PATH]... &lt;COMMAND>

Commands:
  all   Enabled all available options
  help  Print this message or the help of the given subcommand(s)

Arguments:
  &lt;PATH>...  The path(s) you should provide

Options:
  -b, --bytes         Print the byte counts
  -c, --chars         Print the character counts
  -w, --words         Print the word counts
  -l, --lines         Print the line counts
  -L, --longest-line  Print the maximum line width (Unicode)
  -h, --help          Print help information
  -V, --version       Print version information</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å“‡å“¦! è‹¥ä½ ç”¨è¿™æ®µæ–‡å­—, å¯¹æ¯”ä¸‹å‰é¢çš„ src/cli.rs, ä¼šå‘ç°å…ˆå‰çš„æ–‡æ¡£æ³¨é‡Š, åœ¨å£°æ˜å®çš„å¨åŠ›ä¸‹, å˜æˆäº† help ä¿¡æ¯<br>æ²¡é”™! clap èƒ½è‡ªåŠ¨å¸®ä½ åšå¾ˆå¤šäº‹æƒ…, åŒ…æ‹¬ä½†ä¸é™äºé€šè¿‡æ–‡æœ¬æ³¨é‡Šæ¥ç”Ÿæˆ help ä¿¡æ¯<br><br>å¦‚æœä½ ä¸æƒ³è¦ about ä¿¡æ¯ç›´æ¥ç…§æ¬ Cargo.toml é‡Œçš„ description æ€ä¹ˆåŠ? æ²¡äº‹, ç›´æ¥è¦†å†™å°±è¡Œ, è¦†å†™çš„ä¼˜å…ˆçº§æ›´é«˜:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">#[derive(Parser)]
#[command(
    about = "...",
// ......
// ......</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å¹¶ä¸”, åƒ author/version/about ç­‰ä¿¡æ¯, æ˜¯é€šè¿‡è¯»å– Cargo.toml æ¥è·å–çš„, ä½†åœ¨ v4 ç‰ˆæœ¬, clap é»˜è®¤ä¸æ˜¾ç¤º, ä»¥ä¿æŒç®€æ´<br>ä½ å¯ä»¥æŸ¥çœ‹ <a class="underline underline-offset-5 font-medium" href="https://docs.rs/clap/latest/clap/builder/struct.Command.html#method.help_template">help_template</a> çŸ¥æ™“å¦‚ä½•æ˜¾ç¤º, ä¾‹å­å¯èƒ½æ˜¯ builderå½¢å¼, ä¹Ÿå°±æ˜¯éå£°æ˜å¼, ä½†åˆ«æ…Œå¼ :<br><br>ä½ å¯ä»¥åƒè¿™æ ·å°† builderå½¢å¼ çš„ä»£ç è½¬åŒ–ä¸º deriveå½¢å¼<br>å®é™…ä¸Š, å®çš„é»‘é­”æ³•, å°±æ˜¯å°†è¿™äº›å£°æ˜å¼ä»£ç , åœ¨ç¼–è¯‘æœŸè½¬åŒ–ä¸º builder ä»£ç <br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">Command::new("myprog")
    .help_template("{bin} ({version}) - {usage}")

#[derive(Parser)]
#[command(
    help_template = "{bin} ({version}) - {usage}",
// ......
// ......</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <h2 class="flex items-center w-fit my-6" id="xuan-xiang-yu-can-shu"><span class="text-2xl m-2 text-cyan-500">></span> <a class="text-2xl hover:underline underline-offset-8" href="#xuan-xiang-yu-can-shu">é€‰é¡¹ä¸å‚æ•°</a></h2>
      <p>clap èƒ½éå¸¸æ–¹ä¾¿åœ°ä»¥å£°æ˜çš„æ–¹å¼, å®šä¹‰é€‰é¡¹/å‚æ•°<br>å¯¹äºä¸€ä¸ªoption, æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>-b/--bytes</code></code>, ä½ åªéœ€è¦è¿™æ ·å†™:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">/// Print the byte counts
#[arg(short, long)]
pub bytes: bool,</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆ:</p>
      <ul class="list-disc ml-5">
        <li>æ–‡æ¡£æ³¨é‡Š: help ä¸­å¯¹è¯¥å‘½ä»¤çš„è§£é‡Š</li>
        <li>arg(short, long): è¯¥ option å…·æœ‰çŸ­/é•¿æ¨ªæ çš„å½¢å¼</li>
        <li>ç±»å‹ä¸ºbool: ä¼ å…¥æ—¶é»˜è®¤çš„è¡Œä¸ºæ˜¯å°†å…¶è®¾ç½®ä¸º true</li>
      </ul>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">Options:
  -b, --bytes         Print the byte counts</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å½“ä½ ä¼ å…¥è¯¥å‚æ•°æ—¶, Cli å®ä¾‹ä¸­çš„ bytes å±æ€§å°†è¢«è®¾ç½®ä¸º true<br>ä½ ä¹Ÿå¯ä»¥è‡ªè¡ŒæŒ‡å®š short/long çš„åç§°, ä¸æŒ‡å®šæ—¶, shortå–é¦–å­—æ¯, longå–å…¨éƒ¨<br><br>æ¯”å¦‚ <code class="font-semibold text-[#aa8bd5]"><code>-l/--lines</code></code> ä¸ <code class="font-semibold text-[#aa8bd5]"><code>-L/--longest-line</code></code>, ä¸æŒ‡å®šæ—¶éƒ½æ˜¯ -l, ç¼–è¯‘ä¼šæŠ¥é”™, éœ€è¦è‡ªå·±æŒ‡å®š:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">/// Print the maximum line width (Unicode)
#[arg(short = 'L', long)]
pub longest_line: bool,</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å½“ä½ æ²¡æœ‰æ·»åŠ  short æˆ– long æ—¶, è‡ªç„¶å°±ä»£è¡¨è¿™æ˜¯ä¸ª argument<br>åœ¨è¿™é‡Œ, æˆ‘ä»¬å”¯ä¸€éœ€è¦çš„å‚æ•°, æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªè·¯å¾„, å› æ­¤æˆ‘ä»¬ä½¿ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>Vec&lt;PathBuf></code></code> æ¥è¡¨ç¤ºå®ƒ, clap ä¼šè‡ªåŠ¨å°†å‚æ•°è§£æä¸ºè·¯å¾„<br>ä¸ºäº†é†’ç›®, æˆ‘ä»¬å°†å…¶æ˜¾ç¤ºåœ¨ help ä¸­çš„åå­—, æ”¹ä¸ºå¤§å†™çš„ <code class="font-semibold text-[#aa8bd5]"><code>PATH</code></code>, åŒæ—¶æŒ‡å®šè¯¥å‚æ•°å¿…é€‰, é˜²æ­¢è·¯å¾„æ•°ä¸º0:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">/// The path(s) you should provide
#[arg(value_name = "PATH", required = true)]
pub paths: Vec&lt;PathBuf>,</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å¦‚æœä½ ä¸è¾“å…¥å‚æ•°, å‘½ä»¤è¡Œå°±ä¼šä¼˜é›…åœ°æ˜¾ç¤ºé”™è¯¯, å‹å–„åœ°æ¥æé†’ä½ <br>å½“æˆ‘ä»¬è¾“å…¥ <code class="font-semibold text-[#aa8bd5]"><code>cargo run -- -b</code></code>:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">error: The following required arguments were not provided:
  &lt;PATH>...

Usage: rwc &lt;--bytes|--chars|--words|--lines|--longest-line> &lt;PATH>...

For more information try '--help'</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä½†æ­¤æ—¶, å…¶å®è¿˜æœ‰ä¸€ä¸ªé—®é¢˜: å‚æ•°è™½ç„¶è¢«è½¬åŒ–ä¸º <code class="font-semibold text-[#aa8bd5]"><code>PathBuf</code></code>, ä½†ä¸å­˜åœ¨çš„è·¯å¾„ä¹Ÿæ˜¯è·¯å¾„å•Š! æ­¤æ—¶å°±åº”è¯¥æŠ¥é”™æ‰è¡Œ<br>æ²¡é”™, clap åªæ˜¯è´Ÿè´£å¸®æˆ‘ä»¬ç”Ÿæˆ è¿›è¡Œè½¬æ¢çš„ä»£ç <br>ä½†éªŒè¯å­˜åœ¨æ€§ç­‰å·¥ä½œ, åº”è¯¥è‡ªå·±æ¥å®Œæˆ, æ¯•ç«Ÿ clap åˆä¸çŸ¥é“è¿™ä¸ªå‚æ•°ä¼šè¢«æ‹¿å»å¹²å•¥ :)<br><br>å› æ­¤, æˆ‘ä»¬æ¥å­¦å­¦å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰çš„å‚æ•°è§£æå™¨å§<br></p>
      <h2 class="flex items-center w-fit my-6" id="can-shu-jie-xi-qi"><span class="text-2xl m-2 text-cyan-500">></span> <a class="text-2xl hover:underline underline-offset-8" href="#can-shu-jie-xi-qi">å‚æ•°è§£æå™¨</a></h2>
      <p>æœ‰äº›ç–‘é—®æˆ–è®¸ä¼šè¦ç»•åœ¨ä½ çš„å¿ƒå¤´:<br></p>
      <ul class="list-disc ml-5">
        <li>clap æ˜¯æ€ä¹ˆè¿›è¡Œè§£æçš„?</li>
        <li>clap èƒ½å¦å°†ä¼ å…¥çš„å‚æ•°, è§£æä¸ºè‡ªå®šä¹‰çš„ç±»å‹å‘¢?</li>
        <li>æˆ‘ä»¬èƒ½å¦åœ¨ç”¨æˆ·ç©¿å‚æ—¶, æ£€æŸ¥å‚æ•°æ˜¯å¦åˆæ³•, éæ³•çš„ç›´æ¥æŠ¥é”™, æ¥æé†’ç”¨æˆ·å‘¢?</li>
      </ul>
      <p><br>å®é™…ä¸Š, ä½ éœ€è¦é€šè¿‡å‘åä¸º value_parser çš„å‡½æ•°, ä¼ å…¥ä¸€ä¸ªè§£æå™¨, é€šè¿‡è°ƒç”¨è¯¥è§£æå™¨æ¥å¯¹å‚æ•°è¿›è¡Œè§£æä¸éªŒè¯<br>æ¯”å¦‚, å¦‚æœæˆ‘ä»¬æƒ³éªŒè¯ä¼ å…¥çš„è·¯å¾„æ˜¯å¦åˆæ³•, å¯ä»¥è¿™æ ·å†™:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// ......
// ......
    /// The path(s) you should provide
    #[arg(value_parser = check_path, value_name = "PATH", required = true)]
    pub paths: Vec&lt;PathBuf>,
// ......
// ......

fn check_path(filename: &amp;str) -> Result&lt;PathBuf, String> {
    let path = PathBuf::from(filename);
    if filename == "-" || path.exists() {
        Ok(path)
    } else {
        Err(format!("No such path: `{}`", path.display()))
    }
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>good, ç°åœ¨å½“ä½ ä¼ å…¥è·¯å¾„æ—¶, ç¨‹åºä¼šå¯¹è·¯å¾„è¿›è¡ŒéªŒè¯, è‹¥è·¯å¾„ä¸å­˜åœ¨, é‚£å°±è¿”å›ä¸€ä¸ªé”™è¯¯<br>è¯¥é”™è¯¯ä¼šåœ¨ç”¨æˆ·ä¼ å…¥éæ³•è·¯å¾„æ—¶, ä½œä¸ºæŠ¥é”™ä¿¡æ¯å‡ºç°<br>å½“æˆ‘ä»¬è¾“å…¥ <code class="font-semibold text-[#aa8bd5]"><code>cargo run -- -b asdxxx</code></code>:</p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">error: Invalid value "asd" for '&lt;PATH>...': No such path: `asdxxx`

For more information try '--help'</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>äºæ­¤åŒæ—¶, clap å·²ç»ä¸ºéå¸¸å¤šçš„åŸºæœ¬ç±»å‹, å¸¸ç”¨ç±»å‹, åµŒå¥—åŸºæœ¬ç±»å‹, åµŒå¥—å¸¸ç”¨ç±»å‹å®ç°äº†éå¸¸å¤šçš„ parser<br>å¾—ç›Šäºæ­¤, ä½ å¯ä»¥ä¸ºä»»ä½•ç±»å‹å®šä¹‰å¯¹åº”çš„ parser<br></p>
      <h2 class="flex items-center w-fit my-6" id="can-shu-guan-xi"><span class="text-2xl m-2 text-cyan-500">></span> <a class="text-2xl hover:underline underline-offset-8" href="#can-shu-guan-xi">å‚æ•°å…³ç³»</a></h2>
      <p>æœ‰æ—¶å€™, æˆ‘ä»¬å¯èƒ½ä¼šé¢ä¸´è¿™æ ·æˆ–é‚£æ ·çš„é—®é¢˜:<br></p>
      <ul class="list-disc ml-5">
        <li>å½“å¯ç”¨è¿™ä¸ª option æ—¶, å¦å¤–ä¸€ä¸ªä¸å…¶å†²çªçš„ option ä¸åº”è¯¥è¢«å¯ç”¨</li>
        <li>ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šçš„ option(s) å¿…é¡»è¢«å¯ç”¨</li>
        <li>å¤šä¸ªæŒ‡å®šçš„ options å¯ä»¥åŒæ—¶è¢«å¯ç”¨</li>
      </ul>
      <p>å¦‚ä½•å®ç°è¿™äº›å…³ç³»? ä½ å¯èƒ½ä¼šæƒ³è‡ªå·±æ‰‹å†™, ä½†æ—¶é—´ä¸åº”è¯¥æµªè´¹åœ¨è¿™äº›äº‹æƒ…ä¸Š, åœ¨ clap ä¸­, æœ‰ç€å¯¹åº”æœºåˆ¶æ¥å¤„ç†è¿™äº›äº‹æƒ…<br>å®ƒå«åš <em>å‚æ•°å…³ç³»(Argument Relations)</em>, å½“å‚æ•°ä¸ç¬¦åˆå¯¹åº”å…³ç³»æ—¶, ä¼šå‡ºç°å‹å–„çš„æŠ¥é”™ä¿¡æ¯, æç¤ºç”¨æˆ·åº”è¯¥å¦‚ä½•ä¿®æ”¹<br>å› æ­¤, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <em>Arg/ArgGroup (å‚æ•°ä¸å‚æ•°ç»„)</em> æ¥å£°æ˜è¿™äº›å…³ç³»<br><br>å®é™…ä¸Š, ä½ å…ˆå‰åœ¨ <code class="font-semibold text-[#aa8bd5]"><code>paths</code></code> å¤´ä¸Šå†™çš„ <code class="font-semibold text-[#aa8bd5]"><code>required = true</code></code>, å°±æ˜¯ä¸€ç§å‚æ•°å…³ç³»<br><br>ä»¥æˆ‘ä»¬çš„ rwc ä¸¾ä¸ªä¾‹å­:<br></p>
      <ul class="list-disc ml-5">
        <li><code class="font-semibold text-[#aa8bd5]"><code>-b/-c/-w/-l/-L</code></code> èƒ½åŒæ—¶å‡ºç°, å³æ”¯æŒç±»ä¼¼ <code class="font-semibold text-[#aa8bd5]"><code>-b -c -w æˆ– -bcw</code></code> çš„å½¢å¼</li>
        <li><code class="font-semibold text-[#aa8bd5]"><code>-b/-c/-w/-l/-L</code></code> è‡³å°‘å‡ºç°å…¶ä¸­ä¸€ä¸ª, é˜²æ­¢åªä¼ è·¯å¾„ä¸ä¼  option</li>
      </ul>
      <p><br>ä»»ä½•ä¸€ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>Arg</code></code> ç±»å‹ (è¢« <code class="font-semibold text-[#aa8bd5]"><code>#[arg]</code></code> æ‰€ä¿®é¥°çš„), æˆ–è€… <code class="font-semibold text-[#aa8bd5]"><code>ArgGroup</code></code>, éƒ½èƒ½å¤Ÿå£°æ˜è¿™ç§å‚æ•°é—´çš„å…³ç³»<br>æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ª <code class="font-semibold text-[#aa8bd5]"><code>ArgGroup</code></code> çš„å®ä¾‹, ç„¶åæŠŠå…ˆå‰çš„ä¸€å¨ <code class="font-semibold text-[#aa8bd5]"><code>-b/-c/-w/-l/-L</code></code> éƒ½æ”¾å…¥å…¶ä¸­:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// ......
// ......
#[derive(Parser)]
#[command(
    author, version, about, subcommand_negates_reqs = true,
    group(
        ArgGroup::new("options")
            .multiple(true)
            .required(true)
            .args(&amp;[ "bytes", "chars", "words", "lines", "longest_line"])
    ),
)]
pub struct Cli {
    /// The path(s) you should provide
    #[arg(value_parser = check_path, value_name = "PATH", required = true)]
    pub paths: Vec&lt;PathBuf>,
// ......
// ......</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p><code class="font-semibold text-[#aa8bd5]"><code>multiple(true)</code></code> è¡¨ç¤ºå¯ä»¥åŒæ—¶å‡ºç°å‚æ•°ç»„çš„æˆå‘˜, <code class="font-semibold text-[#aa8bd5]"><code>required(true)</code></code> è¡¨ç¤ºè‡³å°‘ä¼ å…¥è¯¥å‚æ•°ç»„ä¸­çš„å…¶ä¸­ä¸€ä¸ªæˆå‘˜<br></p>
      <h2 class="flex items-center w-fit my-6" id="zi-ming-ling"><span class="text-2xl m-2 text-cyan-500">></span> <a class="text-2xl hover:underline underline-offset-8" href="#zi-ming-ling">å­å‘½ä»¤</a></h2>
      <p>æˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰ä¸€ä¸ª subcommand, ç”¨æ¥å¯ç”¨æ‰€æœ‰çš„ options, å®ƒä¹Ÿè¦æ¥å—ä¸€ä¸ªè·¯å¾„ä½œä¸ºå‚æ•°<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">pub struct Cli {
// ......
// ......
    #[command(subcommand)]
    pub sub_commands: Option&lt;SubCommands>,
}

#[derive(Subcommand)]
pub enum SubCommands {
    /// Enabled all available options
    All {
        /// The path(s) you should provide
        #[arg(value_parser = check_path, value_name = "PATH", required = true)]
        paths: Vec&lt;PathBuf>,
    },
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä½ å¯ä»¥ä¼šæƒ³, èƒ½ä¸èƒ½è®©å­å‘½ä»¤å¤ç”¨ <code class="font-semibold text-[#aa8bd5]"><code>Cli</code></code> ä¸­å®šä¹‰çš„ <code class="font-semibold text-[#aa8bd5]"><code>paths</code></code>, å‡å°‘é‡å¤ä»£ç å‘¢?<br>å½“ç„¶å¯ä»¥, è¯·åœ¨å…¶æˆå‘˜ <code class="font-semibold text-[#aa8bd5]"><code>paths</code></code> å¤´ä¸Šçš„ <code class="font-semibold text-[#aa8bd5]"><code>#[arg]</code></code> ä¸­, æ·»åŠ  <code class="font-semibold text-[#aa8bd5]"><code>global = true</code></code>, è¡¨ç¤ºè¯¥å‚æ•°æ˜¯å…¨å±€æ€§çš„, ç›¸å½“äºå­å‘½ä»¤ä¸­ä¹Ÿæ·»åŠ äº†è¿™ä¹ˆä¸ªå‚æ•°<br><br>ä½†éå¸¸é—æ†¾, å½“è®¾ç½® <code class="font-semibold text-[#aa8bd5]"><code>global = true</code></code> å, å°±æ— æ³•è®¾ç½® <code class="font-semibold text-[#aa8bd5]"><code>required = true</code></code> äº†, å› æ­¤æˆ‘ä»¬è¿˜æ˜¯å¾—å®šä¹‰ä¸€ä»½ç›¸åŒçš„å‚æ•°, è¯¦è§ç›¸å…³çš„ <a class="underline underline-offset-5 font-medium" href="https://github.com/clap-rs/clap/issues/1546">issue</a><br><br><em>æ³¨æ„</em>:<br>è¿™é‡Œå…¶å®å¯ä»¥é€‰æ‹©ä¸å®šä¹‰ subcommand, å½“æ²¡æœ‰ä¼ å…¥ options æ—¶é»˜è®¤å¼€å¯æ‰€æœ‰ options, æ¥ç®€åŒ–ç”¨æˆ·è¾“å…¥<br>ä½†æœ¬æ–‡è¿˜æ˜¯å®šä¹‰äº† subcommand ä»¥ä¾¿è¯»è€…äº†è§£, èµ·æ¼”ç¤ºä½œç”¨<br></p>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="luo-ji-shi-xian"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#luo-ji-shi-xian">é€»è¾‘å®ç°</a></h1>
      <p>æ ¹æ®:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">   â”œâ”€â”€ wc_result.rs   # è®¡ç®—å¹¶å­˜å‚¨ç»“æœ
   â”œâ”€â”€ cli.rs         # å‘½ä»¤è¡Œçš„å®šä¹‰
   â”œâ”€â”€ files.rs       # è¯»å–æ–‡ä»¶</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>æˆ‘ä»¬å·²ç»å®Œæˆäº†å¯¹å‘½ä»¤è¡Œçš„å®šä¹‰, æ¥ä¸‹æ¥è¦åšçš„, å°±æ˜¯æ ¹æ® Cli çš„å†…å®¹æ¥å®ç°é€»è¾‘äº†<br>ä¸ºäº†é¿å…ä½ å›åˆ°å‰é¢çœ‹ lib.rs çš„å†…å®¹, ä¸‹é¢å†è´´ä¸€é:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/lib.rs
use std::{collections::HashMap, path::PathBuf};

pub mod cli;
pub mod files;
pub mod wc_result;

pub type Result&lt;T> = std::result::Result&lt;T, Box&lt;dyn std::error::Error>>;
pub type Counts = Vec&lt;usize>;
pub type PathWithContent = HashMap&lt;PathBuf, String>;</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ä¸‹é¢æ˜¯å¯¹åº”æ¨¡å—çš„é€»è¾‘å®ç°, åœ¨æˆ‘çš„åšå®¢ä¸­æ˜¯ä»¥tabçš„å½¢å¼å‘ˆç°, æ¯”è¾ƒæ¸…æ™°, å…¶ä»–å¹³å°æœªçŸ¥:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/files.rs
// å£°æ˜ä¾èµ–
// æˆ‘å†™çš„æ—¶å€™é‡è§æ²¡æœ‰å¯¼å…¥çš„, ä¹Ÿæ˜¯ç›´æ¥ç”¨ lsp æ¥è‡ªåŠ¨å¯¼å…¥, ç›´æ¥ä¸åé¢çš„ä»£ç å¯¹ç…§çœ‹ä¼šæ¯”è¾ƒå¥½
use crate::{PathWithContent, Result};
use indicatif::{MultiProgress, ProgressBar, ProgressStyle};
use rayon::prelude::*;
use std::ffi::OsStr;
use std::process;
use std::sync::atomic::{AtomicUsize, Ordering};
use std::{
    fs::File,
    io::{BufReader, Read},
    path::PathBuf,
};


// `INPUTTED_FILE_NUMBER` è¡¨ç¤º INPUT çš„ç¼–å·, æ˜¯æœ¬æ–‡å¼€ç¯‡çš„ asciinema å±•ç¤ºä¸­çš„æ•ˆæœ
// `BUFFER_SIZR` è¡¨ç¤ºæ¯æ¬¡è¯»å–æ–‡ä»¶æ—¶ç¼“å†²åŒºçš„å¤§å° (å®ç°è¿›åº¦æ¡)
static INPUTTED_FILE_NUMBER: AtomicUsize = AtomicUsize::new(0);
const BUFFER_SIZR: usize = 16 * 1024;


// ä½¿ç”¨ trait æ¥æ‰©å±•æ ‡å‡†åº“ä¸­çš„ PathBuf ç±»å‹, æœ‰ä¸¤ä¸ªå‡½æ•°, ä¸€ä¸ªæ£€æµ‹æ˜¯å¦æ˜¯ä»¥ç‚¹å¼€å¤´çš„, ä¸€ä¸ªåŠ ä¸Šç‚¹å‰ç¼€
// æ¯”å¦‚, å½“ä½ ä¼ å…¥ `./build.rs` ä¸ `build.rs`, å‰è€…è¾“å‡ºæ—¶æœ‰ç‚¹å‰ç¼€, åè€…æ²¡æœ‰, å› æ­¤ç»Ÿä¸€ä¸‹
// å¹¶ä¸”å½“æ˜¯ä» stdin è¯»å–çš„æ—¶å€™, å°±æ˜¾ç¤ºæ— ç‚¹å‰ç¼€çš„ `Input/0` ä¼šæ›´æ¸…æ™°
trait PathExt {
    fn without_dotted_prefix(&amp;self) -> bool;
    fn add_dotted_prefix(&amp;mut self);
}

impl PathExt for PathBuf {
    fn without_dotted_prefix(&amp;self) -> bool {
        self.is_relative() &amp;&amp; !self.starts_with("../") &amp;&amp; !self.starts_with("./")
    }

    fn add_dotted_prefix(&amp;mut self) {
        *self = PathBuf::from_iter([OsStr::new("./"), self.as_os_str()]);
    }
}

// è¯»å–æ–‡ä»¶çš„å‡½æ•°, è¢«æš´éœ²ç»™å…¶ä»–æ¨¡å—, å‚æ•°æ˜¯ä¸€ä¸ªè·¯å¾„æ•°ç»„
pub fn read_files(paths: Vec&lt;PathBuf>) -> Result&lt;PathWithContent> {
    println!("Reading files / Getting content from stdin:");

    // å…¶å®è¿™é‡Œçš„ filter ä¸å¤ªå¥½, è¿˜å¯ä»¥åˆ¤æ–­ç›®å½•ä¸é€’å½’è¯»å–, ä½†æš‚æ—¶å°±è¿™æ ·å§
    let result = paths
        .into_par_iter()
        .filter(|path| path.is_file() || path.as_os_str() == "-")
        .map(|mut path| {
            let should_read_from_input = path.as_os_str() == "-";

            let content = get_content(&amp;path, should_read_from_input);

            if path.without_dotted_prefix() {
                path.add_dotted_prefix();
            }

            if should_read_from_input {
                let inputted_file_number = INPUTTED_FILE_NUMBER.fetch_add(1, Ordering::SeqCst);
                path = PathBuf::from(format!("Input/{}", inputted_file_number));
            }

            let content = content.unwrap_or_else(|err| {
                eprintln!("{}: {}", path.display(), err);
                process::exit(1);
            });

            (path, content)
        })
        .collect();
    Ok(result)
}

// helper å‡½æ•°, é’ˆå¯¹å•ä¸ªè·¯å¾„
fn get_content(path: &amp;PathBuf, should_read_from_input: bool) -> Result&lt;String> {
    if should_read_from_input {
        read_from_stdin()
    } else {
        let bars = MultiProgress::new();
        let style =
            ProgressStyle::with_template("[{elapsed}][{percent}%] {bar:45.cyan/blue} {bytes} {wide_msg}")?
                .progress_chars(">-");
        read_file_with_progress(path, style, bars)
    }
}

// è¯»å–å¯¹åº”è·¯å¾„çš„æ–‡ä»¶
fn read_file_with_progress(path: &amp;PathBuf, style: ProgressStyle, bars: MultiProgress) -> Result&lt;String> {
    let mut content = String::new();

    let file = File::open(path)?;
    let size = file.metadata()?.len();

    let bar = ProgressBar::new(size).with_message(format! {"Reading {}", path.display()}).with_style(style);
    let bar = bars.add(bar);

    let mut bufreader = BufReader::new(file);
    let mut buf = [0; BUFFER_SIZR];

    while let Ok(n) = bufreader.read(&amp;mut buf) {
        if n == 0 {
            break;
        }
        bar.inc(n as u64);
        content += &amp;String::from_utf8_lossy(&amp;buf[..n]);
    }
    bar.finish_with_message("Done!");

    Ok(content)
}

// ä» stdin ä¸­è¯»å–, ä½œä¸ºä¸´æ—¶æ–‡ä»¶çš„å†…å®¹
fn read_from_stdin() -> Result&lt;String> {
    let mut content = vec![];
    std::io::stdin().read_to_end(&amp;mut content)?;
    Ok(String::from_utf8(content)?)
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/wc_result.rs
// å£°æ˜ä¾èµ–
use crate::{
    cli::{Cli, SubCommands},
    files::read_files,
    Counts, Result,
};
use prettytable::{cell, format::consts::FORMAT_BOX_CHARS, Row, Table};
use rayon::prelude::*;
use std::{collections::HashMap, path::PathBuf, str};

// å­˜æ”¾è¢«å¯ç”¨çš„ options, ä¸é”®å€¼å¯¹
pub struct WcResult {
    enabled_options: Vec&lt;&amp;'static str>,
    paths_with_counts: HashMap&lt;PathBuf, Counts>,
}


// å®ä¾‹åŒ–å‡½æ•°
pub fn get(mut cli: Cli) -> Result&lt;WcResult> {
    println!("Please waiting...\n");

    // æ ¹æ®å­å‘½ä»¤è¿›è¡Œç›¸åº”æ“ä½œ
    match cli.sub_commands {
        Some(SubCommands::All { ref paths }) => {
            cli.paths = paths.clone();
            cli.enable_all_options();
        }
        None => cli.enable_all_options(),
    };

    // è¿›è¡Œè®¡ç®—
    println!("Calculating...");
    let wc_result = WcResult {
        enabled_options: cli.get_enabled_options(),
        paths_with_counts: {
            let contents = read_files(cli.paths.clone())?;
            contents.into_par_iter().map(|(path, content)| (path, calculate_counts(&amp;cli, content))).collect()
        },
    };

    Ok(wc_result)
}

impl WcResult {
    // å°†ä¿å­˜çš„ä¿¡æ¯è½¬åŒ–ä¸ºç¾åŒ–åçš„è¡¨æ ¼
    pub fn to_pretty_table(self) -> Table {
        let titles = {
            let enabled_options = self.enabled_options;
            let mut titles = Row::new(enabled_options.into_iter().map(|x| cell!(Fybi -> x)).collect());
            titles.insert_cell(0, cell!(Fybi -> "Path"));
            titles
        };

        let mut table = Table::new();
        table.set_titles(titles);
        table.set_format(*FORMAT_BOX_CHARS);

        for (path, counts) in self.paths_with_counts {
            let mut row = Row::new(counts.into_iter().map(|x| cell!(x)).collect());
            let path_cell = if path.starts_with("Input") {
                cell!(Fbb -> path.display())
            } else {
                cell!(Fmb -> path.display())
            };

            row.insert_cell(0, path_cell);
            table.add_row(row);
        }

        table
    }
}

// ä¸å¤ªæ‡‚ rayon, æš‚æ—¶è¿™æ ·ç³Šä¸Šå»äº†
fn calculate_counts(cli: &amp;Cli, content: String) -> Counts {
    let v: Vec&lt;Option&lt;usize>> = vec![None; 5];
    v.into_par_iter()
        .enumerate()
        .map(|(idx, _)| match idx {
            0 => cli.bytes.then_some(content.len()),
            1 => cli.chars.then_some(content.chars().count()),
            2 => cli.words.then_some(content.split_whitespace().count()),
            3 => cli.lines.then_some(content.lines().count()),
            4 => cli
                .longest_line
                .then_some(content.lines().map(unicode_width::UnicodeWidthStr::width).max().unwrap_or(0)),
            _ => None,
        })
        .flatten()
        .collect()
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// src/mian.rs
use clap::Parser;
use rust_wc::{cli::Cli, wc_result, Result};

fn main() -> Result&lt;()> {
    let cli = Cli::parse();
    let pretty_table = wc_result::get(cli)?.to_pretty_table();
    pretty_table.printstd();
    Ok(())
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <hr class="border-2 border-dashed my-10">
      <h1 class="flex items-center w-fit my-6" id="zi-dong-bu-quan"><span class="text-2xl mr-2 text-cyan-500">ğŸ”—</span> <a class="text-4xl hover:underline underline-offset-8" href="#zi-dong-bu-quan">è‡ªåŠ¨è¡¥å…¨</a></h1>
      <p>æˆ‘ä»¬å·²ç»å†™å¥½äº†å‘½ä»¤è¡Œç¨‹åº, å¯ä»¥é€šè¿‡ <code class="font-semibold text-[#aa8bd5]"><code>-h/--help</code></code> æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯, ä½†èƒ½ä¸èƒ½æ›´æ–¹ä¾¿åœ°ä¸ shell é›†æˆå‘¢?<br>æ¯”å¦‚, å½“ä½ ä½¿ç”¨ bash/zsh/fish æ—¶, è¾“å…¥å‘½ä»¤åç‚¹ Tab, èƒ½å¸®ä½ è‡ªåŠ¨æ˜¾ç¤ºè¯¥å‘½ä»¤çš„ flag/subcommand<br><br>æˆ‘ä»¬å°†ä½¿ç”¨ clap_complete è¿™ä¸ªåº“, åœ¨ç¼–è¯‘å™¨ç”Ÿæˆç‰¹å®šäº shell çš„è‡ªåŠ¨è¡¥å…¨æ–‡ä»¶(ä¹Ÿå¯ä»¥è¿è¡Œæ—¶ç”Ÿæˆ, çœ‹ <a class="underline underline-offset-5 font-medium" href="https://docs.rs/clap_complete/latest/clap_complete/">clap_complete</a> çš„æ–‡æ¡£)<br>é¦–å…ˆè¦ä¿®æ”¹ Cargo.toml, åœ¨åé¢æ·»åŠ  build-dependencies:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-toml text-sm sm:text-base"># Cargo.toml
[build-dependencies]
clap = {version = "4.0.29", features = ["derive"]}
clap_complete = "4.0.6"</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-rust text-sm sm:text-base">// build.rs
use clap::CommandFactory;
use clap_complete::{generate_to, shells::*};
use std::error::Error;

include!("src/cli.rs");

fn main() -> Result&lt;(), Box&lt;dyn Error>> {
    let outdir = "completions";
    let app_name = "rwc";
    let mut cmd = Cli::command();

    generate_to(Bash, &amp;mut cmd, app_name, outdir)?;
    generate_to(Zsh, &amp;mut cmd, app_name, outdir)?;
    generate_to(Fish, &amp;mut cmd, app_name, outdir)?;
    generate_to(Elvish, &amp;mut cmd, app_name, outdir)?;
    generate_to(PowerShell, &amp;mut cmd, app_name, outdir)?;

    Ok(())
}</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>ç›®å‰, clap_complete ä»…æ”¯æŒä»¥ä¸Šå‡ ç§ shell, æ›´å¤šçš„åå°ä¼— shell, ä¸€èˆ¬ä»¥ clap_complete_xxx çš„å½¢å¼å‡ºç°åœ¨ crates.io ä¸Š<br>æ¯”å¦‚ clap_complete_nushell, ä½†äº²æµ‹è´¨é‡ä¸ä½³, ä¸å»ºè®®ä½¿ç”¨<br><br>åŒæ—¶, è¯·ç¡®ä¿é¡¹ç›®æ ¹ç›®å½•ä¸‹å­˜åœ¨ completions ç›®å½•, éšåè¿è¡Œ cargo build, é€šè¿‡ tree å‘½ä»¤å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„è¡¥å…¨æ–‡ä»¶:<br></p>
      <pre class="group relative mx-2 sm:mx-6 my-4 border-2 border-slate-500 leading-[1.2em]"><script>
        function copy_code(button) {
          const code = button.parentElement.querySelector('code').innerText;
          navigator.clipboard.writeText(code).then(() => {
            button.textContent = 'å¥½å•¦';
            setTimeout(() => button.textContent = 'å¤åˆ¶', 2000);
          });
        }
        function fold_code(button) {
          const code = button.parentElement.querySelector('code');
          const next_fold_state = button.textContent
          if (next_fold_state == 'æŠ˜å ') {
            if (!code.hasAttribute('data-original')) {
              code.setAttribute('data-original', code.innerHTML)
            }
            const lines = code.innerHTML.split('\n')
            const firstLine = lines[0]
            code.innerHTML = firstLine
            // code.style.display = 'none'
            button.textContent = 'å±•å¼€'
          } else {
            const lines = code.getAttribute('data-original')
            // code.style.display = 'block'
            code.innerHTML = lines
            button.textContent = 'æŠ˜å '
          }
        }
      </script><p><code class=" language-text text-sm sm:text-base">completions
â”œâ”€â”€ _rwc
â”œâ”€â”€ rwc.bash
â”œâ”€â”€ rwc.elv
â”œâ”€â”€ rwc.fish
â””â”€â”€ _rwc.ps1</code></p><button class="absolute top-2 right-2 hidden group-hover:inline text-xl" onclick="copy_code(this)">å¤åˆ¶</button><button class="absolute top-2 right-16 hidden group-hover:inline text-xl" onclick="fold_code(this)">æŠ˜å </button></pre>
      <p>å°±é…±, æœ¬æ–‡ç»“æŸå•¦!<br>å¸Œæœ›æœ¬æ–‡èƒ½å¸®åˆ°ä½ , è®©ä½ å¿«é€Ÿäº†è§£ä½¿ç”¨ clap çš„æµç¨‹ :)<br></p>
    </div>
  </body>
</html>
